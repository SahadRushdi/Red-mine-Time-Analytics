<% html_title "Team Analytics Configuration" %>

<div class="contextual">
  <%= link_to 'New Team', new_admin_ta_team_path, class: 'icon icon-add' %>
  <%= link_to 'Settings', admin_ta_team_settings_path, class: 'icon icon-settings' %>
</div>

<h2>Team Analytics Configuration</h2>

<% if @all_teams.empty? %>
  <p class="nodata"><%= l(:label_no_data) %></p>
  <p>
    Create your first team to start configuring team analytics.<br/>
    <%= link_to 'Create Team', new_admin_ta_team_path, class: 'icon icon-add' %>
  </p>
<% else %>
  <div class="autoscroll">
    <h3>Organizational Hierarchy</h3>
    <div class="team-hierarchy">
      <%= ta_team_tree(@root_teams) %>
    </div>
  </div>

  <div class="box">
    <p><strong>Total Teams:</strong> <%= @all_teams.count %></p>
    <p><strong>Root Teams:</strong> <%= @root_teams.count %></p>
    <p><strong>Total Active Members:</strong> <%= TaTeamMembership.active.distinct.count(:user_id) %></p>
  </div>
<% end %>

<style>
  .team-hierarchy {
    margin-top: 15px;
  }
  .ta-team-item {
    padding: 10px;
    margin: 2px 0;
    border-bottom: 1px solid #e0e0e0;
  }
  .ta-team-item.level-0 {
    font-weight: bold;
    background-color: #f5f5f5;
    padding-left: 15px;
    margin-left: 0;
  }
  .ta-team-item.level-1 {
    padding-left: 40px;
    background-color: #fafafa;
  }
  .ta-team-item.level-2 {
    padding-left: 65px;
  }
  .ta-team-item.level-3 {
    padding-left: 90px;
  }
  .ta-team-name {
    font-size: 14px;
    margin-right: 8px;
  }
  .ta-team-member-count {
    color: #666;
    font-size: 12px;
    margin-right: 15px;
  }
  .ta-team-item a {
    margin-right: 8px;
  }
</style>
