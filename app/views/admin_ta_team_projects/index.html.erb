<% html_title "Team Projects - #{@team.name}" %>

<div class="contextual">
  <%= link_to 'Assign Project', new_admin_ta_team_team_project_path(@team), class: 'icon icon-add' %>
  <%= link_to 'Back to Teams', admin_ta_teams_path, class: 'icon icon-cancel' %>
</div>

<h2>Team Projects: <%= @team.name %></h2>
<p class="subtitle"><%= ta_team_breadcrumb(@team) %></p>

<h3>Active Projects (<%= @active_projects.count %>)</h3>

<% if @active_projects.any? %>
  <table class="list">
    <thead>
      <tr>
        <th>Project</th>
        <th>Identifier</th>
        <th>Start Date</th>
        <th>End Date</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <% @active_projects.each do |team_project| %>
        <tr class="<%= cycle('odd', 'even') %>">
          <td><%= link_to team_project.project.name, project_path(team_project.project) %></td>
          <td><code><%= team_project.project.identifier %></code></td>
          <td><%= format_date(team_project.start_date) %></td>
          <td><%= team_project.end_date ? format_date(team_project.end_date) : 'Active' %></td>
          <td class="buttons">
            <%= link_to 'Edit', edit_admin_ta_team_team_project_path(@team, team_project), class: 'icon icon-edit' %>
            <%= link_to 'Remove', admin_ta_team_team_project_path(@team, team_project), 
                        method: :delete, data: { confirm: 'Are you sure?' }, class: 'icon icon-del' %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <p class="nodata">No active projects assigned</p>
<% end %>

<% if @inactive_projects.any? %>
  <h3>Inactive Projects (<%= @inactive_projects.count %>)</h3>
  <table class="list">
    <thead>
      <tr>
        <th>Project</th>
        <th>Identifier</th>
        <th>Start Date</th>
        <th>End Date</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <% @inactive_projects.each do |team_project| %>
        <tr class="<%= cycle('odd', 'even') %>">
          <td><%= link_to team_project.project.name, project_path(team_project.project) %></td>
          <td><code><%= team_project.project.identifier %></code></td>
          <td><%= format_date(team_project.start_date) %></td>
          <td><%= format_date(team_project.end_date) %></td>
          <td class="buttons">
            <%= link_to 'Delete', admin_ta_team_team_project_path(@team, team_project), 
                        method: :delete, data: { confirm: 'Are you sure?' }, class: 'icon icon-del' %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>
